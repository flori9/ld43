<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-100</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Vars
textcolor = make_color_rgb(56, 50, 44);
textcolorlight = make_color_rgb(56 * 1.5, 50 * 1.5, 44 * 1.5);
buttonsprite = spr_button;
bgsprite = spr_message;
messageText = "";
headerInfo = -1; //character_get
tooltipAlt = "";
age = 0;
buttons = ds_list_create();
continueText = "- Click to Continue -";
continueScript = -1;
continueScriptArg = -1;
continueBlocked = false;
forceButtonsAtHalfW = false;
forceButtonsAtThirdW = false;

/*
messageText = "Hey! Don't steal my pigs! They are my most important possession and I can't afford to lose them.";
headerInfo = character_get("Farmer");
continueBlocked = true;

message_button_add("Indifferent", spr_mage1_icon, -1, -1, -1, "");
message_button_add("Understanding", spr_mage1_icon, -1, -1, -1, "");
var iconList = ds_list_create();
ds_list_add(iconList, spr_pig_icon_cost);
ds_list_add(iconList, spr_pig_icon_cost);
message_button_add("Aggressive", spr_mage1_icon, iconList, -1, -1, "");
message_button_add("Negotiate", spr_mage2_icon, -1, -1, -1, "");
message_button_add("Groink", spr_pig_icon, -1, -1, -1, "The pig can talk too!");
tooltipAlt = "Choose an attack!";*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Clean up
ds_list_destroy(buttons);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Age
age++;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>///Draw a message
var ww = room_width - 4;

draw_set_font(fnt_small);
var headerHeight = 0;
if (headerInfo &gt;= 0)
    headerHeight = 12;
var messageHeight = 0;
if (messageText != "")
    messageHeight = string_height_ext(messageText, 11, ww - 4) + 2;

var buttonsHeight = 0;
var tooltip = "";
var anyButtonHasTooltip = false;
var continueHeight = 0;

if (ds_list_size(buttons) &gt; 0) {
    buttonsHeight = 15;
    var buttonW;
    var currW = 5;
    for (var i = 0; i &lt; ds_list_size(buttons); i++) {
        var thisButton = buttons[| i];
        
        buttonW[i] = button_iconed_get_width(thisButton[? "text"], thisButton[? "mainicon"], thisButton[? "otherIcons"]);
        if (forceButtonsAtHalfW)
            buttonW[i] = ww / 2 - 7;
        if (forceButtonsAtThirdW)
            buttonW[i] = ww / 3 - 6;
        if (currW + buttonW[i] + 3 &gt; ww - 2) {
            currW = 5;
            buttonsHeight += 17;
        }

        currW += buttonW[i] + 3;
        
        if (thisButton[? "tooltip"] != "")
            anyButtonHasTooltip = true;
    }
} else continueHeight = 9;

var hh = 6 + headerHeight + messageHeight + buttonsHeight + continueHeight;
if (anyButtonHasTooltip)
    hh += 11;

var yy = room_height - hh - 2;
draw_panel_sprite(2, yy, ww, hh, bgsprite, 0);

var xx = 5;
yy += 4;

if (headerInfo &gt;= 0) {
    draw_set_font(fnt_medium);
    draw_set_color(textcolor);
    draw_sprite(headerInfo[? "portrait"], 0, xx, yy - 1);
    draw_text(xx + 9, yy, string_capitalize_first(headerInfo[? "name"]));
    if (ds_map_exists(headerInfo, "title") &amp;&amp; headerInfo[? "title"] != "") {
        var nameWidth = string_width(string_capitalize_first(headerInfo[? "name"]));
        draw_set_color(textcolorlight);
        draw_text(xx + 9 + nameWidth, yy, headerInfo[? "title"]);
        draw_set_color(textcolor);
    }
    yy += headerHeight;
}

draw_set_font(fnt_small);
draw_set_color(textcolor);
draw_text_ext(xx, yy, messageText, 11, ww - 4);
yy += messageHeight;

var tooltipY = yy;
if (anyButtonHasTooltip) {
    yy += 11;
}


//Draw buttons
var xx = 5;

if (ds_list_size(buttons) &gt; 0) {
    for (var i = 0; i &lt; ds_list_size(buttons); i++) {
        var thisButton = buttons[| i];
        if (buttonW[i] + xx &gt; ww - 3) {
            xx = 5;
            yy += 17;
        }
        if (do_button_iconed(xx, yy, buttonW[i], thisButton[? "text"], buttonsprite, thisButton[? "mainicon"], thisButton[? "otherIcons"], thisButton[? "enabled"]))
            if (thisButton[? "script"] &gt;= 0) {
                var xx = 5;
                if (thisButton[? "tooltip"] != "") {
                    draw_set_color(textcolor);
                    draw_text(xx, tooltipY, thisButton[? "tooltip"]);
                }          
            
                var scr = thisButton[? "script"];
                var arg = thisButton[? "arg"];
                instance_destroy();
                script_execute(scr, arg);
                exit;
            }
        if (hovering_button_iconed(xx, yy, buttonW[i]))
            tooltip = thisButton[? "tooltip"];
        xx += buttonW[i] + 3;
    }
    yy += 17;
} else {
    yy += 1;
    draw_set_halign(fa_center);
    draw_set_font(fnt_tiny);
    draw_set_color(textcolorlight);
    if (! continueBlocked)
        draw_text(round(xx + ww / 2), yy, continueText);
    draw_set_halign(fa_left);    
    draw_set_font(fnt_small);
    
    yy += 8;
    
    if (! continueBlocked &amp;&amp; age &gt;= 3 &amp;&amp; mouse_check_button_pressed(mb_left)) {
        if (continueScript &gt;= 0) {
            var scr = continueScript;
            var arg = continueScriptArg;
            script_execute(scr, arg);
            instance_destroy();
            exit;
        }
    }
}

var xx = 5;
if (anyButtonHasTooltip) {
    draw_set_color(textcolor);
    draw_text(xx, tooltipY, iif(tooltip == "", tooltipAlt, tooltip));
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
